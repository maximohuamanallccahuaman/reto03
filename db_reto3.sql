-- Creación de la tabla maestra PROVINCIA
CREATE TABLE PROVINCIA (
    IDPROVINCIA INT,
    DESCPROVINCIA VARCHAR(50),
    FECHAREGISTRO DATE
);
ALTER TABLE PROVINCIA ADD CONSTRAINT PROVINCIA_PK PRIMARY KEY (IDPROVINCIA);

-- Crear secuencia incrementable PROVINCIA
CREATE SEQUENCE INCREPROVINCIA
START WITH 1
INCREMENT BY 1;

-- Crear disparador incrementable en la tabla PROVINCIA
CREATE TRIGGER IDPROVI
BEFORE INSERT ON PROVINCIA
FOR EACH ROW
BEGIN
SELECT INCREPROVINCIA.NEXTVAL INTO :NEW.IDPROVINCIA FROM DUAL;
END;
/

-- Creación de la tabla maestra SEDE
CREATE TABLE SEDE (
    IDSEDE INT,
    DESCSEDE VARCHAR(50),
    FECHAREGISTRO DATE
);
ALTER TABLE SEDE ADD CONSTRAINT SEDE_PK PRIMARY KEY (IDSEDE);

-- Crear secuencia incrementable SEDE
CREATE SEQUENCE INCRESEDE
START WITH 1
INCREMENT BY 1;

-- Crear disparador incrementable en la tabla PROVINCIA
CREATE TRIGGER IDSEDE
BEFORE INSERT ON SEDE
FOR EACH ROW
BEGIN
SELECT INCRESEDE.NEXTVAL INTO :NEW.IDSEDE FROM DUAL;
END;
/

-- Creación de la tabla maestra GERENTE
CREATE TABLE GERENTE (
    IDGERENTE INT,
    DESCGERENTE VARCHAR(50),
    FECHAREGISTRO DATE
);
ALTER TABLE GERENTE ADD CONSTRAINT GERENTE_PK PRIMARY KEY (IDGERENTE);

-- Crear secuencia incrementable GERENTE
CREATE SEQUENCE INCREGERENTE
START WITH 1
INCREMENT BY 1;

-- Crear disparador incrementable en la tabla GERENTE
CREATE TRIGGER IDGEREN
BEFORE INSERT ON GERENTE
FOR EACH ROW
BEGIN
SELECT INCREGERENTE.NEXTVAL INTO :NEW.IDGERENTE FROM DUAL;
END;
/

-- Creación de la tabla maestra CONDICION
CREATE TABLE CONDICION (
    IDCONDICION INT,
    DESCCONDICION VARCHAR(50),
    FECHAREGISTRO DATE
);
ALTER TABLE CONDICION ADD CONSTRAINT CONDICION_PK PRIMARY KEY (IDCONDICION);

-- Crear secuencia incrementable CONDICION
CREATE SEQUENCE INCRECONDICION
START WITH 1
INCREMENT BY 1;

-- Crear disparador incrementable en la tabla CONDICION
CREATE TRIGGER IDCONDI
BEFORE INSERT ON CONDICION
FOR EACH ROW
BEGIN
SELECT INCRECONDICION.NEXTVAL INTO :NEW.IDCONDICION FROM DUAL;
END;
/

-- Creación de la tabla transaccional DISTRITO
CREATE TABLE DISTRITO (
    IDDISTRITO INT,
    IDPROVINCIA INT,
    DESCDISTRITO VARCHAR(50),
    FECHAREGISTRO DATE
);
ALTER TABLE DISTRITO ADD CONSTRAINT DISTRITO_PK PRIMARY KEY (IDDISTRITO);

-- Crear secuencia incrementable DISTRITO
CREATE SEQUENCE INCREDISTRITO
START WITH 1
INCREMENT BY 1;

-- Crear disparador incrementable en la tabla DISTRITO
CREATE TRIGGER IDDIST
BEFORE INSERT ON DISTRITO
FOR EACH ROW
BEGIN
SELECT INCREDISTRITO.NEXTVAL INTO :NEW.IDDISTRITO FROM DUAL;
END;
/

-- Creación de la tabla transaccional HOSPITAL
CREATE TABLE HOSPITAL (
    IDHOSPITAL int,
    IDDISTRITO int,
    NOMBRE VARCHAR(50),
    ANTIGUEDAD INT,
    AREA DECIMAL(5,2),
    IDSEDE INT,
    IDGERENTE INT,
    IDCONDICION INT,
    FECHAREGISTRO DATE
);
ALTER TABLE HOSPITAL ADD CONSTRAINT HOSPITAL_PK PRIMARY KEY (IDHOSPITAL);

-- Crear secuencia incrementable HOSPITAL
CREATE SEQUENCE INCREHOSPITAL
START WITH 1
INCREMENT BY 1;

-- Crear disparador incrementable en la tabla HOSPITAL
CREATE TRIGGER IDHOSP
BEFORE INSERT ON HOSPITAL
FOR EACH ROW
BEGIN
SELECT INCREHOSPITAL.NEXTVAL INTO :NEW.IDHOSPITAL FROM DUAL;
END;
/

-- Relacionando la tabla DISTRITO con PROVINCIA
ALTER TABLE DISTRITO ADD CONSTRAINT DISTRITO_PROVINCIA_FK FOREIGN KEY (IDPROVINCIA)
    REFERENCES PROVINCIA (IDPROVINCIA);
    
-- Relacionando la tabla HOSPITAL con DISTRITO
ALTER TABLE HOSPITAL ADD CONSTRAINT HOSPITAL_DISTRITO_FK FOREIGN KEY (IDDISTRITO)
    REFERENCES DISTRITO (IDDISTRITO);
    
-- Relacionando la tabla HOSPITAL con SEDE
ALTER TABLE HOSPITAL ADD CONSTRAINT HOSPITAL_SEDE_FK FOREIGN KEY (IDSEDE)
    REFERENCES SEDE (IDSEDE);
    
-- Relacionando la tabla HOSPITAL con GERENTE
ALTER TABLE HOSPITAL ADD CONSTRAINT HOSPITAL_GERENTE_FK FOREIGN KEY (IDGERENTE)
    REFERENCES GERENTE (IDGERENTE);
    
-- Relacionando la tabla HOSPITAL con CONDICION
ALTER TABLE HOSPITAL ADD CONSTRAINT HOSPITAL_CONDICION_FK FOREIGN KEY (IDCONDICION)
    REFERENCES CONDICION (IDCONDICION);
    
-- Insetar registros en la tabla PROVINCIA
INSERT INTO PROVINCIA (IDPROVINCIA, DESCPROVINCIA, FECHAREGISTRO) VALUES (1,'CAÑETE','11-01-2022');
INSERT INTO PROVINCIA (IDPROVINCIA, DESCPROVINCIA, FECHAREGISTRO) VALUES (2,'HUARAL','15-01-2022');

-- Insetar registros en la tabla SEDE
INSERT INTO SEDE (IDSEDE, DESCSEDE, FECHAREGISTRO) VALUES (1,'San Isidro','18-02-2022');
INSERT INTO SEDE (IDSEDE, DESCSEDE, FECHAREGISTRO) VALUES (2,'Miraflores','20-02-2022');

-- Insetar registros en la tabla GERENTE
INSERT INTO GERENTE (IDGERENTE, DESCGERENTE, FECHAREGISTRO) VALUES (1,'Máximo Huamán','11-03-2022');
INSERT INTO GERENTE (IDGERENTE, DESCGERENTE, FECHAREGISTRO) VALUES (2,'Carlos Quispe','22-04-2022');

-- Insetar registros en la tabla CONDICION
INSERT INTO CONDICION (IDCONDICION, DESCCONDICION, FECHAREGISTRO) VALUES (1,'Debe estar completo','23-05-2022');
INSERT INTO CONDICION (IDCONDICION, DESCCONDICION, FECHAREGISTRO) VALUES (2,'Debe estar hasta la mitad','28-05-2022');

-- Insetar registros en la tabla DISTRITO
INSERT INTO DISTRITO (IDDISTRITO, IDPROVINCIA, DESCDISTRITO, FECHAREGISTRO) VALUES (1, 2,'Chancay','23-02-2022');
INSERT INTO DISTRITO (IDDISTRITO, IDPROVINCIA, DESCDISTRITO, FECHAREGISTRO) VALUES (2, 1,'Imperial','28-02-2022');

-- Insetar registros en la tabla HOSPITAL
INSERT INTO HOSPITAL (IDHOSPITAL, IDDISTRITO, NOMBRE, ANTIGUEDAD, AREA, IDSEDE, IDGERENTE, IDCONDICION, FECHAREGISTRO) 
VALUES (1, 1, 'Centro Médico Sagrado Corazón de Jesús', 50, 2.0, 1, 1, 2, '21-12-2022');

INSERT INTO HOSPITAL (IDHOSPITAL, IDDISTRITO, NOMBRE, ANTIGUEDAD, AREA, IDSEDE, IDGERENTE, IDCONDICION, FECHAREGISTRO) 
VALUES (2, 2, 'Centro de Salud Peralvillo', 58, 3.0, 2, 2, 1, '29-12-2022');